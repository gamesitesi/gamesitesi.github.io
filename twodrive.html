<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Dosya Yükleyici</title>
    <style>
        /* Genel Sayfa Stilleri */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .container {
            width: 80%;
            max-width: 900px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        h2 {
            margin-top: 40px;
            color: #555;
        }

        /* Dosya Yükleme Formu */
        input[type="file"] {
            display: none;
        }

        .upload-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
        }

        .upload-btn:hover {
            background-color: #45a049;
        }

        .file-list {
            margin-top: 20px;
            list-style: none;
            padding: 0;
        }

        .file-list li {
            background-color: #f9f9f9;
            border-radius: 4px;
            margin: 10px 0;
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
        }

        .file-name {
            color: #333;
            font-weight: 500;
        }

        .download-btn {
            background-color: #1a73e8;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 14px;
            border-radius: 4px;
            cursor: pointer;
        }

        .download-btn:hover {
            background-color: #1668c1;
        }

        /* Responsive Tasarım */
        @media (max-width: 768px) {
            .container {
                width: 95%;
                padding: 15px;
            }

            .upload-btn {
                width: 100%;
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>GitHub Dosya Yükleyici</h1>

        <!-- Dosya yüklemek için input -->
        <label for="file-input" class="upload-btn">Dosya Seç ve Yükle</label>
        <input type="file" id="file-input" multiple />

        <h2>Yüklenen Dosyalar</h2>
        <ul id="file-list" class="file-list"></ul>
    </div>

    <script>
        const repoOwner = 'gamesitesi'; // Kullanıcı adı
        const repoName = 'cloud'; // Depo adı
        const branch = 'main'; // Dal adı (Varsayılan olarak 'main' kabul ediliyor)
        const githubToken = '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'; // API token'ınızı buraya koyun

        const apiBase = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/`;

        // Dosyaları yüklemek için fonksiyon
        async function uploadFiles() {
            const fileInput = document.getElementById('file-input');
            const files = fileInput.files;
            if (files.length === 0) {
                alert('Lütfen yüklemek için dosya seçin.');
                return;
            }

            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();

                reader.onload = async function () {
                    const base64Content = reader.result.split(',')[1]; // Base64 kodu alır

                    const response = await fetch(`${apiBase}${file.name}`, {
                        method: 'PUT',
                        headers: {
                            Authorization: `token ${githubToken}`,
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            message: `Add ${file.name}`,
                            content: base64Content,
                            branch: branch,
                        }),
                    });

                    if (response.ok) {
                        alert(`${file.name} dosyası başarıyla yüklendi!`);
                    } else {
                        alert(`${file.name} dosyası yüklenirken bir hata oluştu.`);
                    }
                };

                // Dosyayı Base64 olarak oku
                reader.readAsDataURL(file);
            }

            // Dosyalar yüklendikten sonra listeyi yenileyelim
            fetchFiles();
        }

        // Yüklenen dosyaları listelemek için fonksiyon
        async function fetchFiles() {
            const response = await fetch(apiBase, {
                headers: {
                    Authorization: `token ${githubToken}`,
                },
            });

            const files = await response.json();
            const fileList = document.getElementById('file-list');
            fileList.innerHTML = ''; // Listeyi temizle

            if (files && Array.isArray(files)) {
                files.forEach(file => {
                    const li = document.createElement('li');
                    li.classList.add('file-item');

                    const fileName = document.createElement('span');
                    fileName.classList.add('file-name');
                    fileName.textContent = file.name;

                    const downloadButton = document.createElement('button');
                    downloadButton.classList.add('download-btn');
                    downloadButton.textContent = 'İndir';
                    downloadButton.onclick = () => downloadFile(file.name);

                    li.appendChild(fileName);
                    li.appendChild(downloadButton);
                    fileList.appendChild(li);
                });
            }
        }

        // Dosya indirme işlemi
        function downloadFile(fileName) {
            const fileUrl = `https://raw.githubusercontent.com/${repoOwner}/${repoName}/${branch}/${fileName}`;
            const link = document.createElement('a');
            link.href = fileUrl;
            link.download = fileName;
            link.click();
        }

        // Sayfa yüklendiğinde dosyaları listele
        document.addEventListener('DOMContentLoaded', fetchFiles);

        // Dosyaları yükle butonuna tıklama olayını bağlama
        document.getElementById('file-input').addEventListener('change', uploadFiles);
    </script>
</body>
</html>
