<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" href="ps.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GameSitesi | Pro Portal</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    :root { 
      --bg-dark: #0a0a0a; 
      --sidebar-dark: #121212; 
      --card-dark: #181818; 
      --text-dark: #ffffff; 
      --accent-color: #36d646; 
      --sidebar-width: 260px; 
    }

    /* TEMALAR */
    body.tema-neon-yesil { --accent-color: #36d646; }
    body.tema-gece-mavisi { --accent-color: #007bff; }
    body.tema-altin { --accent-color: #ffcc00; }
    body.tema-ates-kirmizisi { --accent-color: #ff4d4d; }
    
    * { box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body { margin: 0; display: flex; background-color: var(--bg-dark); color: var(--text-dark); overflow-x: hidden; transition: 0.5s; }

    /* GÄ°RÄ°Åž ZORUNLULUÄžU */
    #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; display: none; align-items: center; justify-content: center; }
    .login-box { background: #181818; padding: 40px; border-radius: 25px; border: 2px solid var(--accent-color); text-align: center; max-width: 400px; width: 90%; box-shadow: 0 0 30px var(--accent-color); }

    /* SIDEBAR */
    .sidebar { width: var(--sidebar-width); background: var(--sidebar-dark); border-right: 1px solid #222; height: 100vh; position: fixed; padding: 20px; display: flex; flex-direction: column; z-index: 1001; }
    .sidebar h2 { color: var(--accent-color); text-align: center; margin-bottom: 25px; }
    .sidebar a { color: #999; text-decoration: none; padding: 12px; margin: 5px 0; display: flex; align-items: center; gap: 12px; border-radius: 12px; transition: 0.3s; cursor: pointer; }
    .sidebar a:hover, .sidebar a.active { background: #1f1f1f; color: var(--accent-color); }
    
    /* PROFIL */
    .user-profile { background: #1a1a1a; padding: 18px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #333; display: none; }
    .user-name-row { display: flex; align-items: center; gap: 10px; font-weight: 600; font-size: 14px; }
    .badge-icon { font-size: 16px; color: #ffcc00; }
    .xp-bar-bg { width: 100%; height: 8px; background: #333; border-radius: 10px; margin-top: 10px; overflow: hidden; }
    #xp-progress { width: 0%; height: 100%; background: var(--accent-color); transition: 1s ease; }

    /* ANA ICERIK */
    .main-content { margin-left: var(--sidebar-width); flex: 1; padding: 30px; }
    .ads-container { width: 100%; background: #111; border: 1px dashed #444; border-radius: 15px; margin-bottom: 30px; display: flex; align-items: center; justify-content: center; min-height: 120px; color: #666; font-size: 14px; text-transform: uppercase; }
    .mid-ads { margin: 40px 0; min-height: 150px; border-color: var(--accent-color); opacity: 0.6; }

    /* Ã‡ARK */
    .wheel-box { background: var(--card-dark); padding: 30px; border-radius: 25px; border: 1px solid #222; display: flex; flex-direction: column; align-items: center; margin-bottom: 40px; }
    .wheel-wrap { position: relative; width: 220px; height: 220px; border: 8px solid #222; border-radius: 50%; background: conic-gradient(#36d646 0deg 72deg, #007bff 72deg 144deg, #ffcc00 144deg 216deg, #ff4d4d 216deg 288deg, #9b59b6 288deg 360deg); transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1); }

    /* OYUNLAR */
    .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 20px; }
    .game-card { background: var(--card-dark); border-radius: 18px; overflow: hidden; transition: 0.4s; text-decoration: none; color: inherit; border: 1px solid #222; height: 380px; }
    .game-card:hover { transform: translateY(-8px); border-color: var(--accent-color); }
    .game-card img { width: 100%; height: 160px; object-fit: cover; }
    .game-info { padding: 15px; }
    .game-info h3 { margin: 0; font-size: 16px; color: var(--accent-color); }

    /* ENVANTER MODAL */
    #inventory-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 10000; align-items: center; justify-content: center; }
    .inventory-box { background: #181818; padding: 30px; border-radius: 20px; border: 1px solid var(--accent-color); width: 90%; max-width: 450px; }
    .inv-item { background: #222; padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #333; }
  </style>
</head>
<body class="tema-neon-yesil">

  <div id="login-overlay">
    <div class="login-box">
      <h2 style="color:var(--accent-color)">HoÅŸ Geldin!</h2>
      <p style="color:#aaa; margin-bottom:20px;">Oyunlara eriÅŸmek ve kazanmak iÃ§in giriÅŸ yap.</p>
      <button onclick="window.location.href='/giris.html'" style="background:var(--accent-color); border:none; padding:15px; width:100%; border-radius:12px; font-weight:bold; cursor:pointer;">ÅžÄ°MDÄ° GÄ°RÄ°Åž YAP</button>
      <p onclick="document.getElementById('login-overlay').style.display='none'" style="color:#555; margin-top:15px; cursor:pointer; font-size:12px;">Misafir Olarak Devam Et</p>
    </div>
  </div>

  <div id="inventory-modal">
    <div class="inventory-box">
      <h2 style="color:var(--accent-color); text-align:center;">Envanterim</h2>
      <div id="inventory-list" style="max-height: 300px; overflow-y: auto;"></div>
      <button onclick="document.getElementById('inventory-modal').style.display='none'" style="margin-top:20px; background:#444; color:white; border:none; padding:10px; width:100%; border-radius:8px; cursor:pointer;">Kapat</button>
    </div>
  </div>

  <nav class="sidebar">
    <h2>GameSitesi</h2>
    <a href="/" class="active"><i class="fas fa-home"></i> <span>Ana Sayfa</span></a>
    
    <div id="sidebar-guest-view">
      <a href="/giris.html"><i class="fas fa-sign-in-alt"></i> <span>GiriÅŸ Yap</span></a>
    </div>

    <div class="user-profile" id="user-profile-box">
      <div class="user-name-row">
        <span id="p-name">...</span>
        <i id="active-badge" class="fas" style="display:none;"></i>
      </div>
      <div style="font-size:11px; color:#888;" id="p-rank">YÃ¼kleniyor...</div>
      <div class="xp-bar-bg"><div id="xp-progress"></div></div>
      <div style="font-size:13px; margin-top:8px; color:#ffcc00;">ðŸ’° <span id="p-coin">0</span></div>
      <button onclick="signOut()" style="margin-top:10px; background:#cc1d1d; color:white; border:none; width:100%; padding:5px; border-radius:5px; cursor:pointer;">Ã‡Ä±kÄ±ÅŸ</button>
    </div>

    <div style="margin-top: 15px; border-top: 1px solid #333; padding-top: 15px;">
      <a href="/magaza.html"><i class="fas fa-shopping-cart" style="color:var(--accent-color)"></i> <span style="font-weight:bold; color:var(--accent-color)">MAÄžAZA</span></a>
      <a onclick="openInventory()"><i class="fas fa-box-open"></i> <span>Envanterim</span></a>
      <a href="https://www.youtube.com/@eyprosakir" target="_blank"><i class="fab fa-youtube" style="color:red"></i> <span>YouTube</span></a>
    </div>
  </nav>

  <main class="main-content">
    
    <div class="ads-container"><span>ÃœST REKLAM ALANI</span></div>

    <div class="wheel-box">
       <div style="position:relative;">
          <div style="width:0; height:0; border-left:15px solid transparent; border-right:15px solid transparent; border-top:25px solid white; position:absolute; top:-15px; left:50%; transform:translateX(-50%); z-index:10;"></div>
          <div class="wheel-wrap" id="wheel-main"></div>
       </div>
       <button id="spin-btn" onclick="spinNow()" style="margin-top:20px; background:var(--accent-color); border:none; padding:12px 25px; border-radius:12px; font-weight:bold; cursor:pointer; color:black;">Ã‡ARKIBÄ°R Ã‡EVÄ°R</button>
       <p id="wheel-msg" style="margin-top:10px; font-weight:bold; color:var(--accent-color);"></p>
    </div>

    <div class="games-grid">
      <a href="/games/eaglercraft.1.8.8" class="game-card"><img src="https://preview.redd.it/who-else-uses-eaglercraft-v0-4mik0if38tge1.jpeg?auto=webp&s=1b46e7736db6e1ba0ba51b81df91b3f2abd13f70"><div class="game-info"><h3>Minecraft 1.8.8</h3></div></a>
      <a href="/jmpsak" class="game-card"><img src="https://i.ytimg.com/vi/Hwbrh3wZ2h4/maxresdefault.jpg"><div class="game-info"><h3>Jumping Åžakir</h3></div></a>
      <a href="/portalania" class="game-card"><img src="https://i.hizliresim.com/c3qagy1.png"><div class="game-info"><h3>Portalania</h3></div></a>
      <a href="/onlinecp3" class="game-card"><img src="https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=314,height=314,fit=cover,f=auto/c72f227e8752a72aaa1d0d5418706029/stickman-race.png"><div class="game-info"><h3>Stickman Race</h3></div></a>
      <a href="/stickmanclimb" class="game-card"><img src="https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=314,height=314,fit=cover,f=auto/3c338d4afffa6a269b9642efef13f5ca/stickman-climb-2.png"><div class="game-info"><h3>Stickman Climb</h3></div></a>
      <a href="/sayfa2/appelsec" class="game-card"><img src="https://www.speedrun.com/static/game/ldewn2jd/cover.png?v=ca91491"><div class="game-info"><h3>Appel</h3></div></a>
      <a href="/sayfa2/bsgame" class="game-card"><img src="https://i.scdn.co/image/ab6761610000e5ebf7b952107c126c561c52171e"><div class="game-info"><h3>Coding Wars</h3></div></a>
      <a href="/sayfa2/fc25" class="game-card"><img src="https://shikogamestore.com/wp-content/uploads/2025/07/516863326_1301231364696535_2827501892350202698_n.jpg"><div class="game-info"><h3>FC25 Pack</h3></div></a>
    </div>

    <div class="ads-container mid-ads"><span>ARA REKLAM ALANI</span></div>

    <div class="games-grid">
      <a href="/sayfa2/paperminecraft" class="game-card"><img src="https://img.itch.zone/aW1nLzEyODU0NDA0LnBuZw==/original/asbVhs.png"><div class="game-info"><h3>Paper Minecraft</h3></div></a>
      <a href="/2048" class="game-card"><img src="https://love2dev.com/img/2048-logo-600x310-600x311.png"><div class="game-info"><h3>2048</h3></div></a>
      <a href="/sayfa2/retro" class="game-card"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ3AGiykyDka501MbQl-e4AgCTKAMgow18nzA&s"><div class="game-info"><h3>Retro Cars</h3></div></a>
      <a href="/pinpon" class="game-card"><img src="https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=314,height=314,fit=cover,f=auto/c02dcbba0cc309d178806541248df443/ping-pong-go.png"><div class="game-info"><h3>Pinpon</h3></div></a>
      <a href="/games/uno" class="game-card"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f9/UNO_Logo.svg/640px-UNO_Logo.svg.png"><div class="game-info"><h3>UNO ONLINE</h3></div></a>
      <a href="https://gamesitesi.github.io/games/block_wall_destroyer" class="game-card"><img src="https://imgs.crazygames.com/block-wall-destroyer_16x9/20250602093150/block-wall-destroyer_16x9-cover?metadata=none&quality=60&width=1200&height=630&fit=crop"><div class="game-info"><h3>Block War</h3></div></a>
      <a href="https://gamesitesi.github.io/games/find_the_pets" class="game-card"><img src="https://i.ytimg.com/vi/9e-jiMb3gt4/maxresdefault.jpg"><div class="game-info"><h3>Find Pets</h3></div></a>
      <a href="https://gamesitesi.github.io/games/car_sky_survival" class="game-card"><img src="https://imgs.crazygames.com/car-sky-survival_16x9/20250623083121/car-sky-survival_16x9-cover?metadata=none&quality=60&width=1200&height=630&fit=crop"><div class="game-info"><h3>Sky Survival</h3></div></a>
    </div>

    <div class="ads-container mid-ads"><span>ARA REKLAM ALANI</span></div>

    <div class="games-grid">
      <a href="https://gamesitesi.github.io/crazycars" class="game-card"><img src="https://img.poki-cdn.com/cdn-cgi/image/q=78,scq=50,width=314,height=314,fit=cover,f=auto/2bc8004fcbb4387908a636e2a9d9ab4a/crazy-cars.png"><div class="game-info"><h3>Crazy Cars</h3></div></a>
      <a href="https://gamesitesi.github.io/games/omnom.html" class="game-card"><img src="https://imgs.crazygames.com/games/om-nom-run/cover_16x9-1707829613214.png?metadata=none&quality=60&width=1200&height=630&fit=crop"><div class="game-info"><h3>Om Nom Run</h3></div></a>
      <a href="https://gamesitesi.github.io/games/goescape.html" class="game-card"><img src="https://games.lol/wp-content/uploads/2023/04/go-escape-pc-full-version.jpg"><div class="game-info"><h3>Go Escape</h3></div></a>
      <a href="https://gamesitesi.github.io/games/shoot_goal/index.html" class="game-card"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR_1k8D4PjY_v3U9Z3Y5I5E8Z8Y7S2L0u1h2g&s"><div class="game-info"><h3>Shoot Goal!</h3></div></a>
    </div>

  </main>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAlMVSsdR38Mgsa-J07cFSb6ulXWJ3zDxA",
      authDomain: "gamesitesi.firebaseapp.com",
      projectId: "gamesitesi",
      storageBucket: "gamesitesi.appspot.com",
      messagingSenderId: "773041885856",
      appId: "1:773041885856:web:b262427b8f31af24bcafc5"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // CANLI VERÄ° TAKÄ°BÄ° (ROZET, TEMA, COÄ°N)
    auth.onAuthStateChanged(user => {
      if (user) {
        document.getElementById("login-overlay").style.display = "none";
        document.getElementById("sidebar-guest-view").style.display = "none";
        document.getElementById("user-profile-box").style.display = "block";
        
        db.collection("users").doc(user.uid).onSnapshot(doc => {
          if(doc.exists){
            const data = doc.data();
            document.getElementById("p-name").innerText = user.displayName || user.email.split("@")[0];
            document.getElementById("p-coin").innerText = data.coin || 0;
            document.getElementById('p-rank').innerText = data.xp >= 2000 ? "Efsane" : (data.xp >= 500 ? "Pro" : "Ã‡aylak");
            document.getElementById('xp-progress').style.width = (data.xp % 1000) / 10 + "%";
            
            // Rozeti ismin yanÄ±na getir
            const badgeEl = document.getElementById("active-badge");
            if(data.activeBadge) {
               badgeEl.className = "fas " + data.activeBadge + " badge-icon";
               badgeEl.style.display = "inline-block";
            } else { badgeEl.style.display = "none"; }

            // TemayÄ± anÄ±nda uygula
            if(data.activeTheme) document.body.className = data.activeTheme;
          }
        });
      } else {
        document.getElementById("login-overlay").style.display = "flex";
      }
    });

    // ENVANTER SÄ°STEMÄ°
    async function openInventory() {
      const user = auth.currentUser;
      if(!user) return;
      document.getElementById('inventory-modal').style.display = 'flex';
      const list = document.getElementById('inventory-list');
      list.innerHTML = "YÃ¼kleniyor...";
      
      const doc = await db.collection("users").doc(user.uid).get();
      const inv = doc.data().inventory || [];
      
      if(inv.length === 0) {
        list.innerHTML = "<p style='text-align:center; color:#666;'>Envanterin boÅŸ.</p>";
        return;
      }

      list.innerHTML = "";
      inv.forEach((item) => {
        list.innerHTML += `
          <div class="inv-item">
            <span>${item.name}</span>
            <button onclick="useItem('${item.type}','${item.icon}','${item.name}')" style="background:var(--accent-color); border:none; padding:8px; border-radius:6px; cursor:pointer; font-weight:bold;">Kullan</button>
          </div>
        `;
      });
    }

    // EÅžYA KULLANMA
    async function useItem(type, icon, name) {
      const user = auth.currentUser;
      try {
        if(type === 'rozet') {
          await db.collection("users").doc(user.uid).update({ activeBadge: icon });
        } else if(type === 'tema') {
          let tClass = "tema-" + name.toLowerCase().replace(/\s/g, "-").replace("ÅŸ","s").replace("Ã¼","u").replace("Ä±","i").replace("Ã¶","o").replace("Ã§","c");
          await db.collection("users").doc(user.uid).update({ activeTheme: tClass });
        }
        alert(name + " kuÅŸanÄ±ldÄ±!");
      } catch (e) { alert("Hata!"); }
    }

    function spinNow() {
      const user = auth.currentUser;
      if(!user) return;
      const btn = document.getElementById('spin-btn');
      const wheel = document.getElementById('wheel-main');
      btn.disabled = true;
      let deg = Math.floor(5000 + Math.random() * 5000);
      wheel.style.transform = `rotate(${deg}deg)`;
      setTimeout(async () => {
        const win = [10, 50, 100, 20][Math.floor(Math.random()*4)];
        await db.collection("users").doc(user.uid).update({
          coin: firebase.firestore.FieldValue.increment(win),
          xp: firebase.firestore.FieldValue.increment(50)
        });
        document.getElementById('wheel-msg').innerText = "KazandÄ±n: " + win + " Coin!";
        btn.disabled = false;
      }, 4000);
    }

    function signOut() { auth.signOut().then(() => location.reload()); }
  </script>
</body>
</html>
